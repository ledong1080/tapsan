(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function d(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=d(i);fetch(i.href,r)}})();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const $="/tapsan/";document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("background-music"),y=document.getElementById("page-17"),d=document.getElementById("volume-slider"),l=document.getElementById("volume-icon");let i=!1,r=!1,u=.5;const g=e=>{l&&(e===0?l.textContent="ðŸ”‡":e<.5?l.textContent="ðŸ”‰":l.textContent="ðŸ”Š")};a&&(a.volume=u,d&&(d.value=String(a.volume*100),g(a.volume))),d&&a&&l&&(d.addEventListener("input",e=>{const n=e.target.value,t=parseInt(n,10)/100;a.volume=t,t>0&&(u=t),g(t)}),l.addEventListener("click",()=>{if(a.volume>0)a.volume=0,d.value="0",g(0);else{const e=u>0?u:.5;a.volume=e,d.value=String(e*100),g(e)}}));const E=()=>{if(r||!a||(r=!0,document.querySelectorAll(".sound-visualizer .bar").length===0))return;const n=new(window.AudioContext||window.webkitAudioContext),t=n.createMediaElementSource(a),s=n.createAnalyser();s.fftSize=64,t.connect(s),s.connect(n.destination);const f=new Uint8Array(s.frequencyBinCount),A=()=>{requestAnimationFrame(A),s.getByteFrequencyData(f),document.querySelectorAll(".sound-visualizer .bar").forEach((B,q)=>{const P=q%s.frequencyBinCount,O=f[P]/255*60;B.style.height=`${O}px`})};A()},h=document.querySelector(".book-container"),c=document.querySelectorAll(".page"),b=c.length,v=e=>{if(!e)return;e.querySelectorAll("img[data-src]").forEach(t=>{const s=t.getAttribute("data-src");if(s){const f=s.startsWith("/")?s.substring(1):s;t.src=$+f,t.removeAttribute("data-src"),t.onload=()=>{t.classList.add("loaded")}}})};c[0]&&v(c[0]),c[1]&&v(c[1]);const w=new Array(b).fill(!1),z=()=>{let e=b,n=1;c.forEach((t,s)=>{w[s]?(t.style.zIndex=String(n),n++):(t.style.zIndex=String(e),e--)})},C=()=>{if(!h)return;const e=w.filter(Boolean).length;e===0?(h.classList.add("state-start"),h.classList.remove("state-open","state-end")):e===b?(h.classList.add("state-end"),h.classList.remove("state-start","state-open")):(h.classList.add("state-open"),h.classList.remove("state-start","state-end"))};z(),C(),c.forEach((e,n)=>{e.addEventListener("click",()=>{!i&&a&&(a.play().catch(f=>console.error("Audio play failed:",f)),i=!0,E());const t=c[n+1],s=c[n+2];t&&v(t),s&&v(s),e.classList.toggle("flipped"),w[n]=!w[n],z(),C(),e===y&&a&&(e.classList.contains("flipped")?a.pause():a.play().catch(f=>console.error("Audio play failed:",f)))})});const m=document.getElementById("sparkle-canvas"),o=m.getContext("2d");if(!o)return;m.width=window.innerWidth,m.height=window.innerHeight;let p=[];const L={x:-100,y:-100};window.addEventListener("mousemove",e=>{L.x=e.x,L.y=e.y;for(let n=0;n<2;n++)p.push(new I)}),window.addEventListener("resize",()=>{m.width=window.innerWidth,m.height=window.innerHeight});class I{constructor(){this.x=L.x,this.y=L.y,this.size=Math.random()*5+2,this.speedX=Math.random()*3-1.5,this.speedY=Math.random()*3-1.5,this.color=`hsl(${Math.random()*20+330}, 100%, 75%)`,this.rotation=(Math.random()-.5)*.5,this.rotationSpeed=(Math.random()-.5)*.02}update(){this.x+=this.speedX,this.y+=this.speedY,this.rotation+=this.rotationSpeed,this.size>.2&&(this.size-=.1)}draw(){if(o){o.save(),o.translate(this.x,this.y),o.rotate(this.rotation);const n=this.size/60;o.scale(n,n),o.translate(-75,-75),o.fillStyle=this.color,o.beginPath(),o.moveTo(75,40),o.bezierCurveTo(75,37,70,25,50,25),o.bezierCurveTo(20,25,20,62.5,20,62.5),o.bezierCurveTo(20,80,40,102,75,120),o.bezierCurveTo(110,102,130,80,130,62.5),o.bezierCurveTo(130,62.5,130,25,100,25),o.bezierCurveTo(85,25,75,37,75,40),o.fill(),o.restore()}}}function M(){for(let e=0;e<p.length;e++)p[e].update(),p[e].draw(),p[e].size<=.2&&(p.splice(e,1),e--)}const S=document.getElementById("falling-leaves-container");if(S)for(let n=0;n<50;n++){const t=document.createElement("div");t.classList.add("leaf"),t.style.left=`${Math.random()*100}vw`,t.style.animationDuration=`${Math.random()*8+7}s`,t.style.animationDelay=`-${Math.random()*10}s`,t.style.opacity=String(Math.random()*.6+.4);const s=Math.random()*10+5;t.style.width=`${s}px`,t.style.height=`${s}px`,t.style.backgroundColor=`hsl(330, 100%, ${Math.random()*15+75}%)`,S.appendChild(t)}function x(){o&&o.clearRect(0,0,m.width,m.height),M(),requestAnimationFrame(x)}x()});
