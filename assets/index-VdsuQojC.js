(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function d(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=d(r);fetch(r.href,a)}})();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const $="/tapsan/";document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("background-music"),p=document.getElementById("page-17"),d=document.getElementById("volume-slider"),l=document.getElementById("volume-icon");let r=!1,a=!1,u=.5;const y=e=>{l&&(e===0?l.textContent="ðŸ”‡":e<.5?l.textContent="ðŸ”‰":l.textContent="ðŸ”Š")};s&&(s.volume=u,d&&(d.value=String(s.volume*100),y(s.volume))),d&&s&&l&&(d.addEventListener("input",e=>{const n=e.target.value,t=parseInt(n,10)/100;s.volume=t,t>0&&(u=t),y(t)}),l.addEventListener("click",()=>{if(s.volume>0)s.volume=0,d.value="0",y(0);else{const e=u>0?u:.5;s.volume=e,d.value=String(e*100),y(e)}}));const S=()=>{if(a||!s||(a=!0,document.querySelectorAll(".sound-visualizer .bar").length===0))return;const n=new(window.AudioContext||window.webkitAudioContext),t=n.createMediaElementSource(s),i=n.createAnalyser();i.fftSize=64,t.connect(i),i.connect(n.destination);const f=new Uint8Array(i.frequencyBinCount),L=()=>{requestAnimationFrame(L),i.getByteFrequencyData(f),document.querySelectorAll(".sound-visualizer .bar").forEach((M,P)=>{const q=P%i.frequencyBinCount,O=f[q]/255*60;M.style.height=`${O}px`})};L()},g=document.getElementById("bookWrapper"),c=document.querySelectorAll(".page"),z=c.length,v=e=>{if(!e)return;e.querySelectorAll("img[data-src]").forEach(t=>{const i=t.getAttribute("data-src");if(i){const f=i.startsWith("/")?i.substring(1):i;t.src=$+f,t.removeAttribute("data-src"),t.onload=()=>{t.classList.add("loaded")}}})};c[0]&&v(c[0]),c[1]&&v(c[1]);const w=new Array(z).fill(!1),C=()=>{let e=z,n=1;c.forEach((t,i)=>{w[i]?(t.style.zIndex=String(n),n++):(t.style.zIndex=String(e),e--)})},x=()=>{if(!g)return;const e=w.filter(Boolean).length;e===0?g.className="book-wrapper align-right":e===z?g.className="book-wrapper align-left":g.className="book-wrapper align-center"};C(),x(),c.forEach((e,n)=>{e.addEventListener("click",()=>{!r&&s&&(s.play().catch(f=>console.error("Audio play failed:",f)),r=!0,S());const t=c[n+1],i=c[n+2];t&&v(t),i&&v(i),e.classList.toggle("flipped"),w[n]=!w[n],C(),x(),e===p&&s&&(e.classList.contains("flipped")?s.pause():s.play().catch(f=>console.error("Audio play failed:",f)))})});const h=document.getElementById("sparkle-canvas"),o=h.getContext("2d");if(!o)return;h.width=window.innerWidth,h.height=window.innerHeight;let m=[];const b={x:-100,y:-100};window.addEventListener("mousemove",e=>{b.x=e.x,b.y=e.y;for(let n=0;n<2;n++)m.push(new I)}),window.addEventListener("resize",()=>{h.width=window.innerWidth,h.height=window.innerHeight});class I{constructor(){this.x=b.x,this.y=b.y,this.size=Math.random()*5+2,this.speedX=Math.random()*3-1.5,this.speedY=Math.random()*3-1.5,this.color=`hsl(${Math.random()*20+330}, 100%, 75%)`,this.rotation=(Math.random()-.5)*.5,this.rotationSpeed=(Math.random()-.5)*.02}update(){this.x+=this.speedX,this.y+=this.speedY,this.rotation+=this.rotationSpeed,this.size>.2&&(this.size-=.1)}draw(){if(o){o.save(),o.translate(this.x,this.y),o.rotate(this.rotation);const n=this.size/60;o.scale(n,n),o.translate(-75,-75),o.fillStyle=this.color,o.beginPath(),o.moveTo(75,40),o.bezierCurveTo(75,37,70,25,50,25),o.bezierCurveTo(20,25,20,62.5,20,62.5),o.bezierCurveTo(20,80,40,102,75,120),o.bezierCurveTo(110,102,130,80,130,62.5),o.bezierCurveTo(130,62.5,130,25,100,25),o.bezierCurveTo(85,25,75,37,75,40),o.fill(),o.restore()}}}function B(){for(let e=0;e<m.length;e++)m[e].update(),m[e].draw(),m[e].size<=.2&&(m.splice(e,1),e--)}const A=document.getElementById("falling-leaves-container");if(A)for(let n=0;n<50;n++){const t=document.createElement("div");t.classList.add("leaf"),t.style.left=`${Math.random()*100}vw`,t.style.animationDuration=`${Math.random()*8+7}s`,t.style.animationDelay=`-${Math.random()*10}s`,t.style.opacity=String(Math.random()*.6+.4);const i=Math.random()*10+5;t.style.width=`${i}px`,t.style.height=`${i}px`,t.style.backgroundColor=`hsl(330, 100%, ${Math.random()*15+75}%)`,A.appendChild(t)}function E(){o&&o.clearRect(0,0,h.width,h.height),B(),requestAnimationFrame(E)}E()});
