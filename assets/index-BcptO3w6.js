(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();const a=document.getElementById("bookWrapper");document.getElementById("book");const l=Array.from(document.querySelectorAll(".page")),L=l.length,d=document.getElementById("background-music"),f=document.getElementById("volume-slider"),m=document.getElementById("volume-icon");let r=0;function v(){const o=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),s=Math.min(1100,Math.floor(o*.92)),i=87.5/65;let t=s;const n=Math.floor(e*.78);Math.floor(t*i)>n&&(t=Math.floor(n/i));const h=Math.min(320,Math.floor(o*.7));t<h&&(t=Math.floor(h)),document.documentElement.style.setProperty("--book-width",`${t}px`),document.documentElement.style.setProperty("--book-height",`${Math.floor(t*i)}px`)}function u(){a&&(a.classList.remove("align-right","align-center","align-left"),r===0?a.classList.add("align-right"):r>=L?a.classList.add("align-left"):a.classList.add("align-center"))}function y(o){const e=o.currentTarget;if(!e)return;e.classList.contains("flipped")?(e.classList.remove("flipped"),r=Math.max(0,r-1)):(e.classList.add("flipped"),r=Math.min(L,r+1)),u()}function E(){l.forEach(o=>{o.addEventListener("click",y),o.addEventListener("touchstart",function(){},{passive:!0})})}function b(){l.forEach(o=>{const e=o.querySelector(".page-side.back img[data-src]");e&&!e.src?parseInt(o.getAttribute("data-index")||"0",10)<=4?(e.src=e.dataset.src,e.classList.add("loaded")):new IntersectionObserver((t,n)=>{t.forEach(c=>{c.isIntersecting&&(e.src=e.dataset.src,e.classList.add("loaded"),n.disconnect())})},{root:null,rootMargin:"200px",threshold:.01}).observe(o):e&&e.dataset&&!e.classList.contains("loaded")&&e.src&&e.classList.add("loaded")})}function M(){if(!d||!f)return;d.volume=Number(f.value)/100,f.addEventListener("input",e=>{d.volume=Number(e.target.value)/100});let o=!1;m&&m.addEventListener("click",()=>{o=!o,d.muted=o,m.textContent=o?"ðŸ”ˆ":"ðŸ”Š"})}function p(){v(),u()}function g(){v(),E(),b(),u(),M(),window.addEventListener("resize",w(p,120)),window.addEventListener("orientationchange",()=>setTimeout(p,120))}function w(o,e){let s=null;return function(...i){clearTimeout(s),s=setTimeout(()=>o.apply(this,i),e)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();window.resetBook=function(){l.forEach(o=>o.classList.remove("flipped")),r=0,u()};
