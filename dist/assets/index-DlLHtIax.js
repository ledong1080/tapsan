(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function m(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=m(a);fetch(a.href,r)}})();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/const O="/tapsan/";document.addEventListener("DOMContentLoaded",()=>{const v=document.querySelector(".book-container"),l=document.querySelectorAll(".page"),m=l.length,o=document.getElementById("background-music"),a=document.getElementById(`page-${m}`),r=document.getElementById("volume-slider"),c=document.getElementById("volume-icon");let b=!1,L=!1,y=.5;const p=e=>{c&&(e===0?c.textContent="ðŸ”‡":e<.5?c.textContent="ðŸ”‰":c.textContent="ðŸ”Š")};o&&(o.volume=y,r&&(r.value=String(o.volume*100),p(o.volume))),r&&o&&c&&(r.addEventListener("input",e=>{const n=e.target.value,t=parseInt(n,10)/100;o.volume=t,t>0&&(y=t),p(t)}),c.addEventListener("click",()=>{if(o.volume>0)o.volume=0,r.value="0",p(0);else{const e=y>0?y:.5;o.volume=e,r.value=String(e*100),p(e)}}));const A=()=>{if(L||!o||(L=!0,document.querySelectorAll(".sound-visualizer .bar").length===0))return;const n=new(window.AudioContext||window.webkitAudioContext),t=n.createMediaElementSource(o),s=n.createAnalyser();s.fftSize=64,t.connect(s),s.connect(n.destination);const d=new Uint8Array(s.frequencyBinCount),E=()=>{requestAnimationFrame(E),s.getByteFrequencyData(d),document.querySelectorAll(".sound-visualizer .bar").forEach((M,B)=>{const q=B%s.frequencyBinCount,P=d[q]/255*60;M.style.height=`${P}px`})};E()},g=e=>{if(!e)return;e.querySelectorAll("img[data-src]").forEach(t=>{const s=t.getAttribute("data-src");if(s){const d=s.startsWith("/")?s.substring(1):s;t.src=O+d,t.removeAttribute("data-src"),t.onload=()=>{t.classList.add("loaded")}}})};l[0]&&g(l[0]),l[1]&&g(l[1]);const w=new Array(m).fill(!1),z=()=>{let e=m,n=1;l.forEach((t,s)=>{w[s]?(t.style.zIndex=String(n),n++):(t.style.zIndex=String(e),e--)})};z(),l.forEach((e,n)=>{e.addEventListener("click",()=>{!b&&o&&(o.play().catch(d=>console.error("Audio play failed:",d)),b=!0,A());const t=l[n+1],s=l[n+2];t&&g(t),s&&g(s),e.classList.toggle("flipped"),w[n]=!w[n],z(),n===0&&(e.classList.contains("flipped")?v.classList.add("is-open"):v.classList.remove("is-open")),e===a&&o&&(e.classList.contains("flipped")?o.pause():o.play().catch(d=>console.error("Audio play failed:",d)))})});const u=document.getElementById("sparkle-canvas"),i=u.getContext("2d");u.width=window.innerWidth,u.height=window.innerHeight;let f=[];const h={x:-100,y:-100};window.addEventListener("mousemove",e=>{h.x=e.x,h.y=e.y;for(let n=0;n<2;n++)f.push(new C)}),window.addEventListener("touchmove",e=>{if(e.touches.length>0){const n=e.touches[0];h.x=n.clientX,h.y=n.clientY;for(let t=0;t<2;t++)f.push(new C)}}),window.addEventListener("resize",()=>{u.width=window.innerWidth,u.height=window.innerHeight});class C{constructor(){this.x=h.x,this.y=h.y,this.size=Math.random()*5+2,this.speedX=Math.random()*3-1.5,this.speedY=Math.random()*3-1.5,this.color=`hsl(${Math.random()*20+330}, 100%, 75%)`,this.rotation=(Math.random()-.5)*.5,this.rotationSpeed=(Math.random()-.5)*.02}update(){this.x+=this.speedX,this.y+=this.speedY,this.rotation+=this.rotationSpeed,this.size>.2&&(this.size-=.1)}draw(){if(i){i.save(),i.translate(this.x,this.y),i.rotate(this.rotation);const n=this.size/60;i.scale(n,n),i.translate(-75,-75),i.fillStyle=this.color,i.beginPath(),i.moveTo(75,40),i.bezierCurveTo(75,37,70,25,50,25),i.bezierCurveTo(20,25,20,62.5,20,62.5),i.bezierCurveTo(20,80,40,102,75,120),i.bezierCurveTo(110,102,130,80,130,62.5),i.bezierCurveTo(130,62.5,130,25,100,25),i.bezierCurveTo(85,25,75,37,75,40),i.fill(),i.restore()}}}function I(){for(let e=0;e<f.length;e++)f[e].update(),f[e].draw(),f[e].size<=.2&&(f.splice(e,1),e--)}const x=document.getElementById("falling-leaves-container");if(x)for(let n=0;n<50;n++){const t=document.createElement("div");t.classList.add("leaf"),t.style.left=`${Math.random()*100}vw`,t.style.animationDuration=`${Math.random()*8+7}s`,t.style.animationDelay=`-${Math.random()*10}s`,t.style.opacity=String(Math.random()*.6+.4);const s=Math.random()*10+5;t.style.width=`${s}px`,t.style.height=`${s}px`,t.style.backgroundColor=`hsl(330, 100%, ${Math.random()*15+75}%)`,x.appendChild(t)}function S(){i&&i.clearRect(0,0,u.width,u.height),I(),requestAnimationFrame(S)}S()});
